// COPYRIGHT Dassault Systemes 2015
//===================================================================
//
// CDlgProcessModel.h
// The dialog : CDlgProcessModel
//
//===================================================================
//
// Usage notes:
//
//===================================================================
//CAA2 Wizard Generation Report
//   DIALOG
//End CAA2 Wizard Generation Report
//
//  Oct 2015  Creation: Code generated by the CAA wizard  WANGJIAPENG
//===================================================================
#ifndef CDlgProcessModel_H
#define CDlgProcessModel_H

#include "CATDlgDialog.h"
#include "CATDlgInclude.h"
#include "CATPPRProcess.h"
#include "CAATreeCtrl.h"
#include "TreeNodeSelectNotif.h"
#include "CATPPRProcessModel.h"

class CDlgProcessModel: public CATDlgDialog
{
  // Allows customization/internationalization of command's messages
  // ---------------------------------------------------------------
  DeclareResource( CDlgProcessModel, CATDlgDialog )

  public:

  CDlgProcessModel();
  virtual ~CDlgProcessModel();

public:
	static CDlgProcessModel* GetInstance();
public:
	static CDlgProcessModel* m_pDlgProcessModel;

  int m_NodeLocate;
  int m_nCurrentNum;//当前节点的序号
  CString strNameAndNum;//树节点名称

  //Process所有工艺信息
  CArray<CATPPRProcessModel*,CATPPRProcessModel*> PPRProcessArray;
  //Process所有节点信息
  CArray<ProcessNode*,ProcessNode*> ProcessNodeArray;
  //Process所有层
  CArray<int,int> LayerArray;

  void Build ();

  //清空对话框的内容
  void InitDialogBox();
  //初始化层
  CATBoolean InitLayerArray();
  //生成BOM树
  CATBoolean GenerateBOMTree(CATDlgFrame* frame,CArray<ProcessNode*,ProcessNode*>& ProcessNodeArray);
  //添加对用户交互选择树形结构控件的响应
  void OnTreeNodeSelect(CATCallbackEvent event,void * client,CATNotification* iNotification,CATSubscriberData data,CATCallback callback);
  //获取当前选中的树节点对应的工序节点
  int GetSelectedProcessNode(CString strNode);
  //设置对话框的内容
  CATBoolean SetDialogContent(int Num);
  //获取Editor的内容，可能多行
  CATUnicodeString GetEditorContent(CATDlgEditor* _Editor);
  //获取一个Array中的所有名称
  CString GetArrayContent(CArray<CString,CString>& ProcessItemArray);
  //从XML文件中获取其它工艺内容
  void GetOtherContent(CATUnicodeString strNodeName);
  //判断工序内容是否修改
  CATBoolean GetRefreshFlag(CATUnicodeString EditorContent);
  //点击树不同节点时，更新工序内容
  CATBoolean GetProcessContent(CATUnicodeString strContent);

  protected:

  virtual void OnCDlgProcessModelDiaOKNotification (CATCommand *, CATNotification* , CATCommandClientData data);

  virtual void OnPushButtonFigurePushBActivateNotification (CATCommand *, CATNotification* , CATCommandClientData data);

  virtual void OnPushButtonReviewPushBActivateNotification (CATCommand *, CATNotification* , CATCommandClientData data);

  virtual void OnPushButtonSaveFigurePushBActivateNotification (CATCommand *, CATNotification* , CATCommandClientData data);

  virtual void OnPushButtonSaveModelPushBActivateNotification (CATCommand *, CATNotification* , CATCommandClientData data);

  private:


//CAA2 WIZARD WIDGET DECLARATION SECTION
 CATDlgFrame*      _Frame100;
 CATDlgFrame*      _FrameBOMTree;
 CATDlgLabel*      _Label015;
 CATDlgTabContainer*      _TabContainer002;
 CATDlgTabPage*      _TabPageProcess;
 CATDlgFrame*      _FrameContent;
 CATDlgEditor*      _EditorContent;
 CATDlgFrame*      _FrameRemark;
 CATDlgEditor*      _EditorRemark;
 CATDlgFrame*      _Frame104;
 CATDlgLabel*      _LabelNum;
 CATDlgEditor*      _EditorNum;
 CATDlgLabel*      _LabelName;
 CATDlgEditor*      _EditorName;
 CATDlgFrame*      _Frame108;
 CATDlgLabel*      _LabelBeginTime;
 CATDlgEditor*      _EditorBeginTime;
 CATDlgLabel*      _LabelEndTime;
 CATDlgEditor*      _EditorEndTime;
 CATDlgTabPage*      _TabPageCheck;
 CATDlgFrame*      _FrameCheckContent;
 CATDlgEditor*      _EditorCheckContent;
 CATDlgFrame*      _FrameCheckResult;
 CATDlgEditor*      _EditorCheckResult;
 CATDlgFrame*      _Frame103;
 CATDlgPushButton*      _PushButtonSaveModel;
 CATDlgPushButton*      _PushButtonSaveFigure;
 CATDlgPushButton*      _PushButtonReview;
 CATDlgPushButton*      _PushButtonFigure;
//END CAA2 WIZARD WIDGET DECLARATION SECTION
 CATPPRProcess			*pPPRProcess;
 CAATreeCtrl			*pTreeCtrl;
};

//----------------------------------------------------------------------

#endif
