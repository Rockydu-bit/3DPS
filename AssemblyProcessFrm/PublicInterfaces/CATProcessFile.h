// COPYRIGHT Dassault Systemes 2015
//===================================================================
//
// CATProcessFile.h
// Header definition of CATProcessFile
//
//===================================================================
//
// Usage notes:
//
//===================================================================
//
//  Oct 2015  Creation: Code generated by the CAA wizard  WANGJIAPENG
//===================================================================
#ifndef CATProcessFile_H
#define CATProcessFile_H

#include "FileManagerMdl.h"
#include "CATFile.h"
#include "stdafx.h"
#include "CATIXMLDOMDocumentBuilder.h"
#include "CATIDOMImplementation.h"
#include "CATIDOMDocument.h"
#include "CATIDOMDocumentType.h"
#include "CATIDOMElement.h"
#include "CATIDOMText.h"
#include "CATISAXInputSource.h"
#include "CATIXMLInputStream.h"
#include "CATIXMLSAXFactory.h"
#include "CATIDOMNodeList.h"
#include "CATPPRProcess.h"
#include "CDlgProcessModel.h"
#include "CDlgStepModel.h"
#include "CATPPRProcessModel.h"
#include "CATPPRStepModel.h"

class ExportedByFileManagerMdl CATProcessFile: public CATFile
{
  CATDeclareClass;

  public:

  // Standard constructors and destructors
  // -------------------------------------
     CATProcessFile ();
     virtual ~CATProcessFile ();

  // Copy constructor and equal operator
  // -----------------------------------
  CATProcessFile (CATProcessFile &);
  CATProcessFile& operator=(CATProcessFile&);

public:
	static CATProcessFile* GetInstance();
public:
	static CATProcessFile* m_pProcessFile;

  CArray<CATUnicodeString,CATUnicodeString> StringArray;
  CArray<CATPPRProcessModel*,CATPPRProcessModel*> PPRProcessArray;
  CArray<CATPPRStepModel*,CATPPRStepModel*> PPRStepArray;

  //获取节点工序信息
  void GetProcessAttr(CArray<CATUnicodeString,CATUnicodeString>& StringArray,CATPPRProcessModel* ProcessInfo);
  //获取节点工步信息
  void GetStepAttr(CArray<CATUnicodeString,CATUnicodeString>& StepStringArray,CATPPRStepModel* StepInfo);
  //保存BOM信息，播放器读取
  CATBoolean SaveBOM(CArray<ProcessNode*,ProcessNode*> &ProcessNodeArray);
  //保存工艺信息
  CATBoolean SaveProcessInfo();
  //保存工步信息
  CATBoolean SaveStepInfo(CATIDOMDocument_var document,CATIDOMElement_var spStepList,int num,CArray<CATPPRStepModel*,CATPPRStepModel*>& PPRStepArray);
  //输出报表
  CATBoolean SaveReportForm(CArray<CATPPRProcessModel*,CATPPRProcessModel*>& PPRProcessArray);
  //解析工序信息
  CATBoolean ParseProcessInfo();
  //解析工步信息
  CATBoolean ParseStepInfo(CATIDOMNodeList_var spNodeList,CArray<CATPPRStepModel*,CATPPRStepModel*>& PPRStepArray);
};

//-----------------------------------------------------------------------

#endif
